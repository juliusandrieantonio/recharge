import{$ as d,W as f,a as m,g as o,pd as h,td as c,ud as b}from"./chunk-KD3HKJA5.js";var p=class l{constructor(e){this.db=e}getStudents(){return new o(e=>{let n=b(this.db,"users");c(n,i=>{let a=i.val();if(!a){e.next([]);return}console.log(a);let s=Object.entries(a).map(([r,t])=>({uid:r,status:t.status,email:t.email,phone_number:t.phone_number,role:t.role,available_points:t.available_points,total_bottles:t.total_bottles})).filter(r=>r.role==="student");e.next(s)})})}getMachines(){return new o(e=>{let n=b(this.db,"machine");c(n,i=>{let a=i.val(),s=Object.entries(a).map(([r,t])=>({id:r,name:t.name,status:t.status,activity:t.activity,available_charging_slots:t.available_charging_slots||0,bin_level:t.bin_level||0,charging_slots:t.charging_slots||0,last_modified:new Date(t.last_modified)}));e.next(s)})})}getMonthlyContrib(e){return new o(n=>{let i=b(this.db,"monthly_progress_by_user");c(i,a=>{let s=a.val();if(!s){n.next([]);return}let r=[];Object.values(s).forEach(t=>{t[e]&&Object.entries(t[e]).forEach(([g,_])=>{r.push(m({month:g},_))})}),n.next(r)})})}getDashboard(e){return new o(n=>{let i=b(this.db,`dashboard_stats/${e}`);c(i,a=>{let s=a.val();n.next(s)})})}static \u0275fac=function(n){return new(n||l)(d(h))};static \u0275prov=f({token:l,factory:l.\u0275fac,providedIn:"root"})};export{p as a};
